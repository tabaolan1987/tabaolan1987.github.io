
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Beginner with Selenium WebDriver Part 7 : Keyboard Mouse Events , Uploading Files  - Selenium WebDriver, JMETER Tutorial</title>
    <meta name="author" content="Ta Bao Lan">
   	
	<meta name="description" content="Jmeter Tutorial - learning Jmeter in simple way and easy steps - Selenium tutorial for beginners - learning selenium in simple and easy steps : a beginner's tutorial containing complete knowledge about selenium environment setup, ide, test cases suite, locators, pattern matching, commands, webdrivers, rc, user interactions, design techniques, testng, grids, user extensions, and selenium for mobile applications" />
	
	<meta name="keywords" content="Selenium,WebDriver,Keyboard,Mouse,Uploading,Files,Action,class,Events,Handling,Performs,location,element,Parameters,button" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="/atom.xml" rel="alternate" title="Selenium WebDriver, JMETER Tutorial" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    var pluginUrl =
            '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
    _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
    _gaq.push(['_setAccount', 'UA-51278981-1']);
    _gaq.push(['_trackPageview']);
    function initGa() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    }
    setTimeout(initGa, 5);
</script>



<script src="https://www.gstatic.com/xads/publisher_badge/contributor_badge.js" data-width="88" data-height="31" 
data-theme="light" data-pub-name="tabaolan.com" data-pub-id="ca-pub-5798698216356388"></script>

</head>

<body>

    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
		Selenium WebDriver, JMETER Tutorial
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ad-banner-responsive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5798698216356388"
     data-ad-slot="7145934352"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  <!-- Google Plus -->
  <li>
  <a href="http://plus.google.com/lantabao?rel=author" class="google" title="Google+"></a>
  </li>
  
  
  <!-- Facebook -->
  <li>
  <a href="http://www.facebook.com/gaumun" class="facebook" title="Facebook"></a>
  </li>
  
  
  
  <!-- LinkedIn -->
  <li>
  <a href="http://www.linkedin.com/in/tabaolan" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  <!-- Skype -->
  <li>
  <a href="http://myskype.info/lantb1987" class="skype" title="Skype"></a>
  </li>
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/categories/webdriver/">WebDriver</a></li>
	<li id="ajax"><a href="/categories/newbie/">Selenium Beginner</a></li>
	<li id="ajax"><a href="/categories/testng-framework/">TestNG Framework</a></li>
	<li id="ajax"><a href="/categories/selenium-framework/">Automation Framework</a></li>
	<li id="ajax"><a href="/categories/icecream-framework/">IceCream Framework</a></li>
    <li id="ajax"><a href="/categories/tricks/">Tips&Tricks</a></li>
	<li id="ajax"><a href="/categories/jmeter/">JMETER</a></li>
	<li id="ajax"><a href="/categories/mobiletest/">Mobile Testing</a></li>
	
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>



ï»¿
</header>

<div id="toload">
<!-- begin toload -->
<div id="content" class="inner">

        <article class="post">

	<h2 class="title">Beginner With Selenium WebDriver Part 7 : Keyboard Mouse Events , Uploading Files</h2>
	<div class="entry-content"><h2>Keyboard Mouse Events , Uploading Files &ndash; Webdriver</h2>

<p>In this tutorial we will learn handling keyboard and mouse in Webdriver and deal with file uploads and downloads.</p>

<h3>Handling Keyboard &amp; Mouse Events</h3>

<p><img src="/images/newbie62.jpg"></p>

<p>Handling special keyboard and mouse events are done using the Advanced User Interactions API. It contains the Actions and the Action classes that are needed when executing these events. The following are the most commonly used keyboard and mouse events provided by the Actions class.</p>

<p>Let take a look in methods of Action class below :</p>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5798698216356388" data-ad-slot="3378542759" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></p>

<p>1.clickAndHold() : Clicks (without releasing) at the current mouse location.</p>

<p>2.contextClick() : Performs a context-click at the current mouse location.</p>

<p>3.doubleClick() : Performs a double-click at the current mouse location.</p>

<p>4.dragAndDrop(source, target) : Performs click-and-hold at the location of the source element, moves to the location of the target element, then releases the mouse.Parameters : source- element to emulate button down at,target- element to move to and release the mouse at.</p>

<p>5.dragAndDropBy(source, x-offset, y-offset) : Performs click-and-hold at the location of the source element, moves by a given offset, then releases the mouse.Parameters:source- element to emulate button down at , xOffset- horizontal move offset, yOffset- vertical move offset.</p>

<p>6.keyDown(modifier_key) : Performs a modifier key press. Does not release the modifier key &ndash; subsequent interactions may assume it&rsquo;s kept pressed.Parameters: modifier_key &ndash; any of the modifier keys (Keys.ALT, Keys.SHIFT, or Keys.CONTROL)</p>

<p>7.keyUp(modifier _key) : Performs a key release. Parameters: modifier_key &ndash; any of the modifier keys (Keys.ALT, Keys.SHIFT, or Keys.CONTROL)</p>

<p>8.moveByOffset(x-offset, y-offset) : Moves the mouse from its current position (or 0,0) by the given offset.Parameters:x-offset- horizontal offset. A negative value means moving the mouse left.y-offset- vertical offset. A negative value means moving the mouse up.</p>

<p>9.moveToElement(toElement) : Moves the mouse to the middle of the element. Parameters:toElement- element to move to.</p>

<p>10.release() : Releases the depressed left mouse button at the current mouse location</p>

<p>11.sendKeys(onElement, charsequence) : Sends a series of keystrokes onto the element.Parameters: onElement &ndash; element that will receive the keystrokes, usually a text field , charsequence &ndash; any string value representing the sequence of keystrokes to be sent.</p>

<p>In the following example, we shall use the moveToElement() method to mouse-over on one Mercury Tours&#8217; table rows. See the example below.</p>

<p><img src="/images/newbie63.png"></p>

<p>The cell shown above is a portion of a <TR> element. If not hovered, its color is #FFC455 (orange). After hovering, the cell&rsquo;s color becomes transparent. It becomes the same color as the blue background of the whole orange table.</p>

<h4>Step 1</h4>

<p>Import the Actions and Action classes.</p>

<p><img src="/images/newbie64.png"></p>

<h4>Step 2</h4>

<p>Instantiate a new Actions object.</p>

<p><img src="/images/newbie65.png"></p>

<h4>Step 3</h4>

<p>Instantiate an Action using the Actions object in step 2.</p>

<p><img src="/images/newbie66.png"></p>

<p>In this case, we are going to use the moveToElement() method because we are simply going to mouse-over the &ldquo;Home&rdquo; link. The build() method is always the final method used so that all the listed actions will be compiled into a single step.</p>

<h4>Step 4</h4>

<p>Use the perform() method when executing the Action object we designed in Step 3.</p>

<p><img src="/images/newbie67.png"></p>

<p>Below is the whole WebDriver code to check the background color of the <TR> element before and after the mouse-over.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import org.openqa.selenium.*;
</span><span class='line'>import org.openqa.selenium.firefox.FirefoxDriver;
</span><span class='line'> 
</span><span class='line'>import org.openqa.selenium.interactions.Action;
</span><span class='line'>import org.openqa.selenium.interactions.Actions;
</span><span class='line'> 
</span><span class='line'>public class myclass {
</span><span class='line'> 
</span><span class='line'>public static void main(String[] args) {
</span><span class='line'>String baseUrl = "http://newtours.demoaut.com/";
</span><span class='line'>        WebDriver driver = new FirefoxDriver();
</span><span class='line'> 
</span><span class='line'>        driver.get(baseUrl);           
</span><span class='line'>        WebElement link_Home = driver.findElement(By.linkText("Home"));
</span><span class='line'>        WebElement td_Home = driver
</span><span class='line'>                .findElement(By
</span><span class='line'>                .xpath("//html/body/div"
</span><span class='line'>                + "/table/tbody/tr/td"
</span><span class='line'>                + "/table/tbody/tr/td"
</span><span class='line'>                + "/table/tbody/tr/td"
</span><span class='line'>                + "/table/tbody/tr"));    
</span><span class='line'>         
</span><span class='line'>        Actions builder = new Actions(driver);
</span><span class='line'>        Action mouseOverHome = builder
</span><span class='line'>                .moveToElement(link_Home)
</span><span class='line'>                .build();
</span><span class='line'>         
</span><span class='line'>        String bgColor = td_Home.getCssValue("background-color");
</span><span class='line'>        System.out.println("Before hover: " + bgColor);        
</span><span class='line'>        mouseOverHome.perform();        
</span><span class='line'>        bgColor = td_Home.getCssValue("background-color");
</span><span class='line'>        System.out.println("After hover: " + bgColor);
</span><span class='line'>        driver.quit();
</span><span class='line'>}
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>




<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5798698216356388" data-ad-slot="9425076351" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></p>

<p>The output below clearly states that the background color became transparent after the mouse-over.</p>

<p><img src="/images/newbie68.png"></p>

<h3>Building a Series of Multiple Actions</h3>

<p>You can build a series of actions using the Action and Actions classes. Just remember to close the series with the build() method. Consider the sample code below.</p>

<p><img src="/images/newbie69.png"></p>

<p><img src="/images/newbie70.png"></p>

<h3>Uploading Files</h3>

<p>For this section, we will use <a href="http://www.megafileupload.com/">http://www.megafileupload.com/</a> as our test application. This site easily allows any visitor to upload and download files without requiring them to sign up.</p>

<p>Uploading files in WebDriver is done by simply using the sendKeys() method on the file-select input field to enter the path to the file to be uploaded.</p>

<p><img src="/images/newbie71.png"></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import org.openqa.selenium.*;
</span><span class='line'>import org.openqa.selenium.firefox.FirefoxDriver;
</span><span class='line'>public class myclass {
</span><span class='line'>public static void main(String[] args) {
</span><span class='line'>String baseUrl = "http://www.megafileupload.com/";
</span><span class='line'>WebDriver driver = new FirefoxDriver();
</span><span class='line'> 
</span><span class='line'>driver.get(baseUrl);
</span><span class='line'>WebElement uploadElement = driver.findElement(By.id("uploadfile_0"));
</span><span class='line'> 
</span><span class='line'>// enter the file path onto the file-selection input field
</span><span class='line'>uploadElement.sendKeys("C:\\newhtml.html");
</span><span class='line'> 
</span><span class='line'>// check the "I accept the terms of service" check box
</span><span class='line'>driver.findElement(By.id("terms")).click();
</span><span class='line'> 
</span><span class='line'>// click the "UploadFile" button
</span><span class='line'>driver.findElement(By.name("send")).click();
</span><span class='line'>}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>




<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5798698216356388" data-ad-slot="7145934352" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></p>

<p>After running this script, you should be able to upload the file successfully and you should get a message similar to this.</p>

<p><img src="/images/newbie72.png"></p>

<p>Remember following two things when uploading files in WebDriver</p>

<p>1.There is no need to simulate the clicking of the &ldquo;Browse&rdquo; button.  WebDriver automatically enters the file path onto the file-selection text box of the <input type="file"> element.</p>

<p>2.When setting the file path in your Java IDE, use the proper escape character for the back-slash.</p>

<p><img src="/images/newbie73.png"></p>
</div>

<div class="meta">
	
		<span class="comments"><a href="/NewBie/newbie-part-7-keyboard-mouse-events/#disqus_thread">Comments</a></span>
	
</div>

<br>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

 </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2015

    Ta Bao Lan
. Powered by <a href="http://octopress.org">Octopress</a> . Some source code cloned from <a href="http://www.guru99.com/">Guru</a> 
	<MARQUEE BEHAVIOR="alternate"> Selenium,WebDriver,Keyboard,Mouse,Uploading,Files,Action,class,Events,Handling,Performs,location,element,Parameters,button </MARQUEE>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'tabaolan1987';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.tabaolan.com/NewBie/newbie-part-7-keyboard-mouse-events/';
        var disqus_url = 'http://www.tabaolan.com/NewBie/newbie-part-7-keyboard-mouse-events/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
