
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Upload file with Selenium and AutoIT - Selenium WebDriver, JMETER Tutorial</title>
    <meta name="author" content="Ta Bao Lan">
   	
	<meta name="description" content="Jmeter Tutorial - learning Jmeter in simple way and easy steps - Selenium tutorial for beginners - learning selenium in simple and easy steps : a beginner's tutorial containing complete knowledge about selenium environment setup, ide, test cases suite, locators, pattern matching, commands, webdrivers, rc, user interactions, design techniques, testng, grids, user extensions, and selenium for mobile applications" />
	
	<meta name="keywords" content="Upload file,Selenium,AutoIt" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="/atom.xml" rel="alternate" title="Selenium WebDriver, JMETER Tutorial" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    var pluginUrl =
            '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
    _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
    _gaq.push(['_setAccount', 'UA-51278981-1']);
    _gaq.push(['_trackPageview']);
    function initGa() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    }
    setTimeout(initGa, 5);
</script>




</head>

<body>

    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
		Selenium WebDriver, JMETER Tutorial
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ad-banner-responsive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5798698216356388"
     data-ad-slot="7145934352"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  <!-- Google Plus -->
  <li>
  <a href="http://plus.google.com/lantabao?rel=author" class="google" title="Google+"></a>
  </li>
  
  
  <!-- Facebook -->
  <li>
  <a href="http://www.facebook.com/gaumun" class="facebook" title="Facebook"></a>
  </li>
  
  
  
  <!-- LinkedIn -->
  <li>
  <a href="http://www.linkedin.com/in/tabaolan" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  <!-- Skype -->
  <li>
  <a href="http://myskype.info/lantb1987" class="skype" title="Skype"></a>
  </li>
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/categories/webdriver/">WebDriver</a></li>
	<li id="ajax"><a href="/categories/newbie/">Selenium Beginner</a></li>
	<li id="ajax"><a href="/categories/testng-framework/">TestNG Framework</a></li>
	<li id="ajax"><a href="/categories/selenium-framework/">Automation Framework</a></li>
	<li id="ajax"><a href="/categories/icecream-framework/">IceCream Framework</a></li>
    <li id="ajax"><a href="/categories/tricks/">Tips&Tricks</a></li>
	<li id="ajax"><a href="/categories/jmeter/">JMETER</a></li>
	<li id="ajax"><a href="/categories/mobiletest/">Mobile Testing</a></li>
	<li id="ajax"><a href="/categories/TMT/">Test Management Tool</a></li>
	
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>



ï»¿
</header>

<div id="toload">
<!-- begin toload -->
<div id="content" class="inner">

        <article class="post">

	<h2 class="title">Upload File With Selenium and AutoIT</h2>
	<div class="entry-content"><h2>How to upload file with Selenium and AutoIt</h2>

<h3>Download AutoIt : <a href="https://www.autoitscript.com/site/autoit/downloads/">Click here</a></h3>

<h3>Install AutoIt : Double click on file &ldquo;autoit-v3-setup.exe&rdquo; then click button Next.</h3>

<h3>Scenario :</h3>

<p>You will face with problem when you want to upload a file, you must click on the input and the browser will show the popup like below :</p>

<p><img src="/images/autoit.jpg"></p>

<h3>Solution : We will include script AutoIT into Selenium Script</h3>

<p>Step 1 : After install AutoIt, locate to your desktop, right-click and create a new file: &ldquo;upload_script_autoit.au3&rdquo;</p>

<p>Step 2 : Open file you created above and copy the code below to it :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>; Wait 10 seconds for the Upload window to appear
</span><span class='line'>
</span><span class='line'>WinWait("[CLASS:#32770]", "", 10)
</span><span class='line'>
</span><span class='line'>; Set input focus to the edit control of Upload window using the handle returned by WinWait
</span><span class='line'>
</span><span class='line'>ControlFocus("Open", "", "Edit1")
</span><span class='line'>
</span><span class='line'>Sleep(2000)
</span><span class='line'>
</span><span class='line'>; Set the File name text on the Edit field
</span><span class='line'>
</span><span class='line'>ControlSetText("Open", "", "Edit1", "C:\bt.jpg")
</span><span class='line'>
</span><span class='line'>Sleep(2000)
</span><span class='line'>
</span><span class='line'>; Click on the Open button
</span><span class='line'>
</span><span class='line'>ControlClick("Open", "", "Button1");
</span></code></pre></td></tr></table></div></figure>


<p>Step 3 : Save this file.</p>

<p>Step 4 : right-click to this file &ndash;> Compile script (x86).</p>

<p>Step 5 : You will see the new file : &ldquo;upload_file_autoit.exe&rdquo;. Copy this file to disk C or whatever you want.</p>

<p>Step 6 : write up a simple selenium script with main function like below :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class App 
</span><span class='line'>{
</span><span class='line'>    public static void main( String[] args ) throws IOException, InterruptedException
</span><span class='line'>    {
</span><span class='line'>      String path = PropertiesHelper.getKey("project.basedir")
</span><span class='line'>              + File.separator + "target" + File.separator + "surefire";
</span><span class='line'>      long size = FileUtils.sizeOfDirectory(new File(path));
</span><span class='line'>      System.setProperty("webdriver.chrome.driver",
</span><span class='line'>              DriverUtil.getChromeDriver());
</span><span class='line'>       WebDriver driver = new ChromeDriver();
</span><span class='line'>       
</span><span class='line'>          driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
</span><span class='line'>   
</span><span class='line'>          driver.get("yourURL.com");
</span><span class='line'>   
</span><span class='line'>          //find the input file then click to it.
</span><span class='line'>          driver.findElement(By.id("photo")).click();
</span><span class='line'>          
</span><span class='line'>          // call the autoit script
</span><span class='line'>          Runtime.getRuntime().exec("C:\\upload_file_autoit.exe");
</span><span class='line'>   
</span><span class='line'>          Thread.sleep(5000);
</span><span class='line'>   
</span><span class='line'>          //driver.close();
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

</div>

<div class="meta">
	
		<span class="comments"><a href="/tricks/upload-file-with-selenium/#disqus_thread">Comments</a></span>
	
</div>

<br>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

 </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2015

    Ta Bao Lan
. Powered by <a href="http://octopress.org">Octopress</a> . Some source code cloned from <a href="http://www.guru99.com/">Guru</a> 
	<MARQUEE BEHAVIOR="alternate"> Upload file,Selenium,AutoIt </MARQUEE>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'tabaolan1987';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.tabaolan.com/tricks/upload-file-with-selenium/';
        var disqus_url = 'http://www.tabaolan.com/tricks/upload-file-with-selenium/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
